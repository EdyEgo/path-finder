<script setup lang="ts">
import { useAuth } from '@/stores/auth'

import { ref, watchEffect } from 'vue'
import AuthLayoutVue from '@/layouts/AuthLayout.vue'

const authStore = useAuth()

const valid = ref(true)
const form = ref<any>(null)
const useremail = ref('')
const password = ref('')
const signMethodIsPendding = ref(false)

watchEffect(() => {
  authStore.pendding
  signMethodIsPendding.value = authStore.pendding
})

async function signInWithGoogle() {
  await authStore.signInGoogle()
}

async function signIn() {
  if (form.value.email == '' || form.value.password == '') return

  await authStore.signIn(useremail.value, password.value)
}

const emailRules = ref([
  (v) => !!v || 'E-mail is required',
  (v) => /.+@.+\..+/.test(v) || 'E-mail must be valid'
])

const rules = {
  required: (value) => !!value || 'Required.',
  min: (v) => v.length >= 8 || 'Min 8 characters',
  emailMatch: () => `The email and password you entered don't match`
}

function validate() {
  form.value.validate()
  setTimeout(() => {
    valid.value = true
  }, 2000)
}

function reset() {
  form.value.reset()
}

function resetValidation() {
  form.value.resetValidation()
  valid.value = true
}
</script>

<template>
  <AuthLayoutVue>
    <div class="flex justify-center items-center flex-col">
      <div class="w-[500px]">
        <h1 class="text-center text-white text-[60px]">
          Welcome <span class="text-[#FB8122]">back!</span>
        </h1>

        <v-form ref="form" v-model="valid" @submit="signIn" lazy-validation>
          <div class="inputAuthBorder mt-[43px] mb-[18px]">
            <div class="relative rounded-md shadow-sm">
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
              >
                <svg
                  class="text-[#E1E2E2]"
                  width="19"
                  height="14"
                  viewBox="0 0 17 12"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M15.6 0H1.2C0.88174 0 0.576515 0.126428 0.351472 0.351472C0.126428 0.576515 0 0.88174 0 1.2V10.8C0 11.1183 0.126428 11.4235 0.351472 11.6485C0.576515 11.8736 0.88174 12 1.2 12H15.6C15.9183 12 16.2235 11.8736 16.4485 11.6485C16.6736 11.4235 16.8 11.1183 16.8 10.8V1.2C16.8 0.88174 16.6736 0.576515 16.4485 0.351472C16.2235 0.126428 15.9183 0 15.6 0ZM14.28 1.2L8.4 5.268L2.52 1.2H14.28ZM1.2 10.8V1.746L8.058 6.492C8.15844 6.56168 8.27776 6.59901 8.4 6.59901C8.52224 6.59901 8.64156 6.56168 8.742 6.492L15.6 1.746V10.8H1.2Z"
                    fill="currentColor"
                    fill-opacity="0.7"
                  />
                </svg>
              </div>
              <input
                @keyup="resetValidation"
                v-model="useremail"
                :rules="emailRules"
                required
                type="email"
                name="email"
                id="email"
                class="inputAuth"
                placeholder="E-mail"
              />
            </div>
          </div>
          <div class="inputAuthBorder">
            <div class="relative rounded-md shadow-sm">
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
              >
                <svg
                  class="text-[#E1E2E2]"
                  width="14"
                  height="16"
                  viewBox="0 0 10 12"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.64 5.14286H7.68V2.57143C7.68 1.88944 7.37657 1.23539 6.83647 0.753154C6.29636 0.270918 5.56382 0 4.8 0C4.03618 0 3.30364 0.270918 2.76353 0.753154C2.22343 1.23539 1.92 1.88944 1.92 2.57143V5.14286H0.96C0.705392 5.14286 0.461212 5.23316 0.281177 5.39391C0.101143 5.55465 0 5.77267 0 6V11.1429C0 11.3702 0.101143 11.5882 0.281177 11.7489C0.461212 11.9097 0.705392 12 0.96 12H8.64C8.89461 12 9.13879 11.9097 9.31882 11.7489C9.49886 11.5882 9.6 11.3702 9.6 11.1429V6C9.6 5.77267 9.49886 5.55465 9.31882 5.39391C9.13879 5.23316 8.89461 5.14286 8.64 5.14286ZM2.88 2.57143C2.88 2.11677 3.08229 1.68074 3.44235 1.35925C3.80242 1.03775 4.29078 0.857143 4.8 0.857143C5.30922 0.857143 5.79757 1.03775 6.15764 1.35925C6.51771 1.68074 6.72 2.11677 6.72 2.57143V5.14286H2.88V2.57143ZM8.64 11.1429H0.96V6H8.64V11.1429Z"
                    fill="currentColor"
                    fill-opacity="0.7"
                  />
                </svg>
              </div>
              <input
                v-model="password"
                @keyup="resetValidation"
                :rules="[rules.required, rules.min]"
                type="password"
                class="inputAuth"
                placeholder="Password"
              />
            </div>
          </div>
          <div class="flex items-center justify-between mt-[13px]">
            <div class="flex items-center">
              <input
                id="remember-me"
                name="remember-me"
                type="checkbox"
                class="h-4 w-4"
              />
              <label
                for="remember-me"
                class="ml-2 block text-[12px] text-[#E1E2E2] opacity-40 hover:opacity-100"
              >
                Remember me
              </label>
            </div>

            <div class="text-sm">
              <a
                href="#"
                class="text-[12px] text-[#E1E2E2] opacity-40 hover:opacity-100"
              >
                Forgot your password?
              </a>
            </div>
          </div>
          <div class="flex mt-[45px] items-center justify-center">
            <div class="w-[300px] h-[1px] bg-[#FB8122]"></div>
            <div class="text-[14px] text-[#E1E2E2] mx-[20.5px]">or</div>
            <div class="w-[300px] h-[1px] bg-[#FB8122]"></div>
          </div>
          <div class="flex items-center justify-center mt-[47px]">
            <!--Apple-->
            <svg
              width="26"
              height="30"
              viewBox="0 0 26 30"
              class="text-[#E1E2E2] hover:text-[#FB8122] hover:drop-shadow-4xl"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M20.5985 15.8531C20.5984 15.8412 20.595 15.9601 20.597 16.077C20.5993 16.2122 20.6078 16.398 20.6324 16.6228C20.6814 17.0718 20.7947 17.6788 21.0522 18.3499C21.5452 19.6349 22.5615 21.1387 24.6232 22.2106C24.1866 23.4178 23.3566 25.1742 22.2807 26.6783C21.6923 27.5009 21.0407 28.2333 20.3524 28.7597C19.6646 29.2858 18.9644 29.588 18.2684 29.5988C17.4367 29.5982 16.7726 29.3416 16.0106 29.0471L15.959 29.0272C15.1806 28.7265 14.3146 28.4018 13.1726 28.4018C12.0031 28.4018 11.1026 28.7132 10.3119 29.0111C10.2509 29.0341 10.1908 29.0569 10.1315 29.0794C9.41012 29.3528 8.80448 29.5824 8.10395 29.5989L8.10128 29.599C7.42647 29.6194 6.7207 29.3189 6.00539 28.7601C5.29248 28.2031 4.60465 27.4158 3.97722 26.5325C2.72224 24.7657 1.75429 22.6798 1.33748 21.4816C0.710654 19.6509 0.4 17.8813 0.4 16.1749C0.4 10.4522 4.17926 7.71041 7.68166 7.65453C8.50416 7.65528 9.4652 7.95942 10.3939 8.29106C10.5236 8.33736 10.6532 8.38439 10.7814 8.4309C11.0998 8.54641 11.4093 8.65871 11.6887 8.74872C12.0735 8.87266 12.4578 8.97418 12.7773 8.97418C13.0932 8.97418 13.4964 8.84999 13.8995 8.70908C14.0931 8.6414 14.3021 8.56396 14.5193 8.48346C14.5387 8.47625 14.5583 8.46901 14.5779 8.46175C14.8176 8.37295 15.0687 8.28033 15.3301 8.18938C16.3849 7.82239 17.5573 7.50163 18.6529 7.58838L18.654 7.58846C20.8926 7.75952 22.589 8.59058 23.7598 10.0689C22.7742 10.729 22.0085 11.5014 21.4769 12.4014C20.8803 13.4116 20.5914 14.5614 20.5985 15.8531ZM20.5985 15.8531C20.5985 15.8533 20.5985 15.8536 20.5985 15.854H20.9985L20.5985 15.8563C20.5985 15.8552 20.5985 15.8541 20.5985 15.8531ZM14.5939 2.60072L14.5939 2.60074L14.5974 2.59675C15.5075 1.53484 17.0554 0.653732 18.4506 0.441536C18.4797 1.30162 18.3603 2.8777 16.9167 4.59838C15.7527 5.96175 14.4042 6.75088 12.9681 6.76632C12.9388 5.18706 13.5611 3.7742 14.5939 2.60072Z"
                stroke="currentColor"
                stroke-width="0.8"
              />
            </svg>
            <!--GitHub-->
            <svg
              width="31"
              height="32"
              viewBox="0 0 31 32"
              class="text-[#E1E2E2] hover:text-[#FB8122] hover:drop-shadow-4xl mx-[80px]"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M21.572 31C21.572 31.2209 21.7511 31.4 21.972 31.4C22.1929 31.4 22.372 31.2209 22.372 31H21.572ZM21.972 26.7008L21.5733 26.6694C21.5724 26.6798 21.572 26.6903 21.572 26.7008H21.972ZM20.5639 22.791L20.5196 22.3935C20.3679 22.4104 20.2391 22.5121 20.1875 22.6557C20.1359 22.7994 20.1705 22.9598 20.2767 23.0694L20.5639 22.791ZM30.211 12.305H30.611V12.305L30.211 12.305ZM27.964 6.68757L27.5892 6.54771C27.5357 6.69113 27.5687 6.85251 27.6743 6.96338L27.964 6.68757ZM27.8292 1.04014L28.1968 0.882556C28.15 0.773255 28.0569 0.690466 27.9429 0.65665L27.8292 1.04014ZM21.972 3.25717L21.8674 3.64324C21.9791 3.67353 22.0986 3.6539 22.1947 3.58942L21.972 3.25717ZM11.4861 3.25717L11.2633 3.58942C11.3595 3.6539 11.4789 3.67353 11.5907 3.64324L11.4861 3.25717ZM5.62891 1.04014L5.51517 0.656649C5.40116 0.690466 5.30811 0.773255 5.26126 0.882556L5.62891 1.04014ZM5.49409 6.68757L5.78379 6.96338C5.88935 6.85252 5.92237 6.69113 5.86885 6.54771L5.49409 6.68757ZM3.24711 12.35H3.64711L3.6471 12.3479L3.24711 12.35ZM12.8942 22.8359L13.1816 23.1141C13.2871 23.0051 13.3218 22.8459 13.2714 22.7029C13.221 22.5599 13.094 22.4577 12.9435 22.439L12.8942 22.8359ZM11.4861 26.7008H11.8861C11.8861 26.6914 11.8857 26.682 11.8851 26.6727L11.4861 26.7008ZM11.0861 31C11.0861 31.2209 11.2652 31.4 11.4861 31.4C11.707 31.4 11.8861 31.2209 11.8861 31H11.0861ZM11.6094 28.3844C11.8195 28.3163 11.9346 28.0907 11.8664 27.8805C11.7983 27.6704 11.5727 27.5553 11.3625 27.6234L11.6094 28.3844ZM1.35777 23.3311C1.25898 23.1335 1.01871 23.0534 0.821115 23.1522C0.623523 23.251 0.543433 23.4912 0.642229 23.6888L1.35777 23.3311ZM22.372 31V26.7008H21.572V31H22.372ZM22.3708 26.7321C22.4314 25.9612 22.3273 25.1863 22.0653 24.4587L21.3126 24.7298C21.5361 25.3505 21.625 26.0117 21.5733 26.6694L22.3708 26.7321ZM22.0653 24.4587C21.8032 23.7312 21.3893 23.0678 20.8511 22.5126L20.2767 23.0694C20.7359 23.5431 21.089 24.1091 21.3126 24.7298L22.0653 24.4587ZM20.6082 23.1885C22.9825 22.9239 25.4923 22.3361 27.4088 20.7247C29.3446 19.0969 30.611 16.4811 30.611 12.305H29.811C29.811 16.3081 28.6056 18.6731 26.8939 20.1124C25.1627 21.5681 22.849 22.1338 20.5196 22.3935L20.6082 23.1885ZM30.611 12.305C30.6106 10.1109 29.7666 8.00088 28.2537 6.41176L27.6743 6.96338C29.0456 8.40379 29.8106 10.3163 29.811 12.3051L30.611 12.305ZM28.3387 6.82743C29.0576 4.90127 29.0068 2.77222 28.1968 0.882556L27.4615 1.19772C28.1904 2.89829 28.2361 4.8143 27.5892 6.54771L28.3387 6.82743ZM27.8292 1.04014C27.9429 0.65665 27.9425 0.656533 27.9421 0.656416C27.942 0.656374 27.9416 0.656255 27.9413 0.656172C27.9407 0.656006 27.9401 0.655833 27.9395 0.655653C27.9383 0.655294 27.9369 0.654908 27.9354 0.654498C27.9325 0.653678 27.9291 0.65276 27.9253 0.651759C27.9176 0.649757 27.9082 0.647422 27.897 0.644873C27.8746 0.639774 27.845 0.633823 27.8082 0.627953C27.7346 0.616208 27.6322 0.604835 27.5001 0.601199C27.2357 0.593921 26.8541 0.617691 26.3475 0.73016C25.335 0.95494 23.825 1.53348 21.7493 2.92491L22.1947 3.58942C24.2085 2.23953 25.6272 1.70955 26.5209 1.51115C26.9673 1.41202 27.2833 1.39553 27.4781 1.4009C27.5756 1.40358 27.6432 1.41175 27.6822 1.41797C27.7018 1.42108 27.7142 1.42372 27.7196 1.42496C27.7224 1.42558 27.7234 1.42586 27.7227 1.42567C27.7223 1.42558 27.7215 1.42537 27.7203 1.42503C27.7197 1.42487 27.719 1.42467 27.7182 1.42443C27.7178 1.42431 27.7173 1.42419 27.7169 1.42405C27.7167 1.42399 27.7163 1.42388 27.7162 1.42384C27.7158 1.42373 27.7154 1.42362 27.8292 1.04014ZM22.0767 2.87109C18.5747 1.922 14.8833 1.922 11.3814 2.87109L11.5907 3.64324C14.9556 2.73129 18.5025 2.73129 21.8674 3.64324L22.0767 2.87109ZM11.7088 2.92491C9.63305 1.53348 8.12311 0.95494 7.11061 0.73016C6.604 0.617691 6.22242 0.593921 5.958 0.601199C5.8259 0.604835 5.7235 0.616208 5.64986 0.627953C5.61306 0.633823 5.5835 0.639773 5.56108 0.644873C5.54986 0.647422 5.54044 0.649757 5.53279 0.651759C5.52897 0.65276 5.52559 0.653678 5.52265 0.654498C5.52118 0.654908 5.51983 0.655294 5.51858 0.655653C5.51796 0.655833 5.51736 0.656006 5.51679 0.656172C5.51651 0.656255 5.5161 0.656374 5.51596 0.656416C5.51556 0.656533 5.51517 0.656649 5.62891 1.04014C5.74266 1.42362 5.74228 1.42373 5.74191 1.42384C5.7418 1.42388 5.74143 1.42399 5.7412 1.42405C5.74074 1.42419 5.7403 1.42431 5.7399 1.42443C5.73908 1.42467 5.73837 1.42487 5.73777 1.42503C5.73656 1.42537 5.73578 1.42558 5.73543 1.42567C5.73472 1.42586 5.73572 1.42558 5.73845 1.42496C5.74392 1.42372 5.75633 1.42108 5.77585 1.41797C5.81485 1.41175 5.8825 1.40358 5.98001 1.4009C6.17481 1.39553 6.49074 1.41202 6.93723 1.51115C7.83092 1.70955 9.24957 2.23953 11.2633 3.58942L11.7088 2.92491ZM5.26126 0.882556C4.45133 2.77222 4.40051 4.90127 5.11934 6.82743L5.86885 6.54771C5.22194 4.81429 5.26768 2.89829 5.99657 1.19772L5.26126 0.882556ZM5.20439 6.41176C3.68022 8.01266 2.83536 10.1417 2.84711 12.3521L3.6471 12.3479C3.63645 10.3443 4.40225 8.41448 5.78379 6.96338L5.20439 6.41176ZM2.84711 12.35C2.84711 16.4973 4.11425 19.0976 6.04932 20.7247C7.96433 22.335 10.4725 22.9382 12.8449 23.2329L12.9435 22.439C10.6121 22.1494 8.29679 21.5693 6.56419 20.1124C4.85164 18.6724 3.64711 16.3218 3.64711 12.35H2.84711ZM12.6067 22.5578C12.0748 23.1074 11.6646 23.7629 11.4028 24.4815L12.1545 24.7554C12.3779 24.1422 12.7278 23.583 13.1816 23.1141L12.6067 22.5578ZM11.4028 24.4815C11.141 25.2001 11.0334 25.9659 11.0871 26.7288L11.8851 26.6727C11.8393 26.0218 11.9311 25.3685 12.1545 24.7554L11.4028 24.4815ZM11.0861 26.7008V31H11.8861V26.7008H11.0861ZM11.3625 27.6234C9.1841 28.33 7.22576 28.3186 5.55469 27.6197C3.88386 26.921 2.44901 25.5135 1.35777 23.3311L0.642229 23.6888C1.79798 26.0003 3.35912 27.5687 5.24602 28.3578C7.13268 29.1468 9.29383 29.1354 11.6094 28.3844L11.3625 27.6234Z"
                fill="currentColor"
              />
            </svg>
            <!--Google-->
            <svg
              @click="signInWithGoogle"
              width="30"
              height="31"
              viewBox="0 0 30 31"
              class="text-[#E1E2E2] hover:text-[#FB8122] hover:drop-shadow-4xl"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M24.3104 4.4566L20.6769 8.1109C19.0802 6.70845 17.0994 5.99137 14.9146 5.99137C9.76147 5.99137 5.59372 10.3631 5.59372 15.5233C5.59372 20.6816 9.761 25.0629 14.9146 25.0629C19.5465 25.0629 22.7744 22.3817 23.437 18.6391L23.5201 18.1693H23.0431H15.3146V13.1196H28.6069C28.7523 14.0005 28.8308 14.9169 28.8308 15.8692C28.8308 20.0643 27.4362 23.6261 25.0148 26.1368C22.5948 28.6459 19.1233 30.1325 14.9146 30.1325H14.9145C13.0086 30.1331 11.1212 29.7559 9.3601 29.0226C7.59902 28.2893 5.99872 27.2141 4.65071 25.8584C3.30269 24.5026 2.23337 22.8929 1.50397 21.1212C0.774575 19.3494 0.399419 17.4504 0.400001 15.5326L0.400001 15.5324C0.399419 13.6146 0.774575 11.7156 1.50397 9.94378C2.23337 8.17201 3.30269 6.5623 4.65071 5.20656C5.99872 3.85083 7.59902 2.77564 9.3601 2.04232C11.1212 1.309 13.0086 0.931887 14.9145 0.932471H14.9146C18.6788 0.932471 21.8417 2.2674 24.3104 4.4566Z"
                stroke="currentColor"
                stroke-width="0.8"
              />
            </svg>
            <!--Facebook-->
            <svg
              width="15"
              height="31"
              viewBox="0 0 15 31"
              class="text-[#E1E2E2] hover:text-[#FB8122] mx-[80px] hover:drop-shadow-4xl"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M13.2348 1.2632C13.4843 1.28289 13.6925 1.30256 13.8516 1.31893L13.7533 5.29233C13.5993 5.2911 13.4055 5.28966 13.1815 5.28822C12.5953 5.28445 11.802 5.28068 10.974 5.28068C10.028 5.28068 9.35373 5.50258 8.94696 6.03289C8.5619 6.53488 8.49721 7.22079 8.49721 7.92006V11.6209V12.0209H8.89721H13.8668L13.6693 16.2892H8.89721H8.49721V16.6892V30.3661H4.04681V16.6892V16.2892H3.64681H0.4V12.0209H3.64681H4.04681V11.6209V7.29186C4.04681 5.67328 4.55872 4.14828 5.6328 3.03046C6.70268 1.917 8.3702 1.16611 10.7647 1.16611C11.7569 1.16611 12.6201 1.21467 13.2348 1.2632Z"
                stroke="currentColor"
                stroke-width="0.8"
              />
            </svg>
            <!--GitLab-->
            <svg
              width="33"
              height="31"
              viewBox="0 0 33 31"
              class="text-[#E1E2E2] hover:text-[#FB8122] hover:drop-shadow-4xl"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M32.4878 17.5049L32.4872 17.5031L27.9992 2.28648C27.7645 1.59199 27.231 1.16611 26.5312 1.16611C25.7967 1.16611 25.2261 1.56901 25.0032 2.23553L25.003 2.23617L22.0288 11.0797L21.9372 11.3522H21.6497H11.273H10.9855L10.8939 11.0798L7.91967 2.24033L7.91944 2.23964C7.69653 1.57312 7.12598 1.17022 6.39152 1.17022C5.67052 1.17022 5.10355 1.61065 4.92864 2.27245L4.92575 2.28338L4.9256 2.28334L0.439595 17.503L0.438792 17.5057C0.321377 17.8939 0.480034 18.3389 0.802553 18.5807L16.4391 30.267L32.1288 18.5804L32.4878 17.5049ZM32.4878 17.5049C32.6061 17.8991 32.4455 18.3433 32.1294 18.58L32.4878 17.5049Z"
                stroke="currentColor"
                stroke-width="0.8"
              />
            </svg>
          </div>
          <div
            class="text-center text-red-500 font-light mb-4 mt-10"
            v-if="authStore.$state.error !== null"
          >
            {{ authStore.$state.error }}
          </div>
          <div class="mt-[40px]">
            <button
              type="submit"
              :disabled="!valid"
              class="w-full bg-gradient-to-l from-[#FB8122] to-[#FBB122] hover:bg-gradient-to-l hover:from-[#FBA622] hover:to-[#FBB122] hover:drop-shadow-buttonLogIn py-[8px] text-[16px] text-black rounded-[8px]"
            >
              Log In
            </button>
            <p class="text-white text-[12px] mt-[18px] text-center">
              Not on admintools.io?<a
                href="/register"
                class="text-[#FB8122] hover:drop-shadow-textShadowLogIn"
              >
                Sign Up</a
              >
            </p>
          </div>
        </v-form>
      </div>
    </div>
  </AuthLayoutVue>
</template>
